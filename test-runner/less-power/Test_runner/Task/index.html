<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Task (less-power.Test_runner.Task)</title><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">less-power</a> &#x00BB; <a href="../index.html">Test_runner</a> &#x00BB; Task</nav><header class="odoc-preamble"><h1>Module <code><span>Test_runner.Task</span></code></h1><p>Common task components for running tests.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-cfg"><a href="#type-cfg" class="anchor"></a><code><span><span class="keyword">type</span> cfg</span><span> = </span><span>{</span></code><ol><li id="type-cfg.build_root" class="def record field anchored"><a href="#type-cfg.build_root" class="anchor"></a><code><span>build_root : <span class="xref-unresolved">FilePath</span>.filename;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>relative paths are OK</p><span class="comment-delim">*)</span></div></li><li id="type-cfg.safe" class="def record field anchored"><a href="#type-cfg.safe" class="anchor"></a><code><span>safe : bool;</span></code></li><li id="type-cfg.build_timeout" class="def record field anchored"><a href="#type-cfg.build_timeout" class="anchor"></a><code><span>build_timeout : <span class="xref-unresolved">Mtime</span>.span;</span></code></li><li id="type-cfg.test_timeout" class="def record field anchored"><a href="#type-cfg.test_timeout" class="anchor"></a><code><span>test_timeout : <span class="xref-unresolved">Mtime</span>.span;</span></code></li><li id="type-cfg.probe_timeout" class="def record field anchored"><a href="#type-cfg.probe_timeout" class="anchor"></a><code><span>probe_timeout : <span class="xref-unresolved">Mtime</span>.span;</span></code></li><li id="type-cfg.exercise_start" class="def record field anchored"><a href="#type-cfg.exercise_start" class="anchor"></a><code><span>exercise_start : float;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>UTC time</p><span class="comment-delim">*)</span></div></li><li id="type-cfg.exercise_end" class="def record field anchored"><a href="#type-cfg.exercise_end" class="anchor"></a><code><span>exercise_end : float;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>UTC time</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check_contains_symlink"><a href="#val-check_contains_symlink" class="anchor"></a><code><span><span class="keyword">val</span> check_contains_symlink : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_file_pp"><a href="#val-write_file_pp" class="anchor"></a><code><span><span class="keyword">val</span> write_file_pp : 
  <span>?label:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'b</span>, unit)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_file_f"><a href="#val-write_file_f" class="anchor"></a><code><span><span class="keyword">val</span> write_file_f : 
  <span>?label:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.Format.formatter, unit, <span><span>(<span class="type-var">'b</span>, unit)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_file_str"><a href="#val-write_file_str" class="anchor"></a><code><span><span class="keyword">val</span> write_file_str : 
  <span>?label:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-configure_show_hidden"><a href="#val-configure_show_hidden" class="anchor"></a><code><span><span class="keyword">val</span> configure_show_hidden : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-remove_files"><a href="#val-remove_files" class="anchor"></a><code><span><span class="keyword">val</span> remove_files : 
  <span>?condition:<span class="xref-unresolved">FileUtil</span>.test_file <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div><div class="spec-doc"><p>Task: remove the files which match <code>condition</code> (default: <code>.ml</code> files). Not recursive: only files in <code>p</code> will be deleted, not in subdirectories.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-copy_files"><a href="#val-copy_files" class="anchor"></a><code><span><span class="keyword">val</span> copy_files : 
  <span>?condition:<span class="xref-unresolved">FileUtil</span>.test_file <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div><div class="spec-doc"><p>Task: copy the files which match <code>condition</code> (default: <code>.ml</code> files). Not recursive: only files in <code>src0</code> will be copied, not in subdirectories.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-load_files"><a href="#val-load_files" class="anchor"></a><code><span><span class="keyword">val</span> load_files : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?condition:<span class="xref-unresolved">FileUtil</span>.test_file <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div><div class="spec-doc"><p>Composition of <a href="#val-remove_files"><code>remove_files</code></a> and <a href="#val-load_files"><code>load_files</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_test_report_directory"><a href="#val-make_test_report_directory" class="anchor"></a><code><span><span class="keyword">val</span> make_test_report_directory : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, unit)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-checker"><a href="#val-checker" class="anchor"></a><code><span><span class="keyword">val</span> checker : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?prohibited:<span class="xref-unresolved">Ast_check</span>.Feature.Set.t <span class="arrow">&#45;&gt;</span></span>
  <span>?limit:int <span class="arrow">&#45;&gt;</span></span>
  <span>?check1:<span class="xref-unresolved">FileUtil</span>.test_file <span class="arrow">&#45;&gt;</span></span>
  <span>?check:<span class="xref-unresolved">FileUtil</span>.test_file <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div><div class="spec-doc"><p>Run the <a href="../../Ast_check/index.html#val-path_violations">AST-checker</a> as a task.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-subprocess_run"><a href="#val-subprocess_run" class="anchor"></a><code><span><span class="keyword">val</span> subprocess_run : 
  <span>?timeout:<a href="../../Common/P_run/index.html#type-timeout_description">Common.P_run.timeout_description</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?args:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <a href="../../Common/P_run/index.html#type-result">Common.P_run.result</a>)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div><div class="spec-doc"><p>Run a process as a task</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-subprocess_result"><a href="#val-subprocess_result" class="anchor"></a><code><span><span class="keyword">val</span> subprocess_result : 
  <span>?hide_stdout:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?hide_stderr:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?command_line:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?error_message:string <span class="arrow">&#45;&gt;</span></span>
  <span>?check_status:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?dump_output:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../Common/P_run/index.html#type-result">Common.P_run.result</a>, <a href="../../Common/P_run/index.html#type-result">Common.P_run.result</a>)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div><div class="spec-doc"><p>Handle the result of a subprocess task.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-subprocess_options"><a href="#type-subprocess_options" class="anchor"></a><code><span><span class="keyword">type</span> subprocess_options</span><span> = </span><span>{</span></code><ol><li id="type-subprocess_options.timeout" class="def record field anchored"><a href="#type-subprocess_options.timeout" class="anchor"></a><code><span>timeout : <span><a href="../../Common/P_run/index.html#type-timeout_description">Common.P_run.timeout_description</a> option</span>;</span></code></li><li id="type-subprocess_options.hide_stdout" class="def record field anchored"><a href="#type-subprocess_options.hide_stdout" class="anchor"></a><code><span>hide_stdout : bool;</span></code></li><li id="type-subprocess_options.hide_stderr" class="def record field anchored"><a href="#type-subprocess_options.hide_stderr" class="anchor"></a><code><span>hide_stderr : bool;</span></code></li><li id="type-subprocess_options.error_message" class="def record field anchored"><a href="#type-subprocess_options.error_message" class="anchor"></a><code><span>error_message : <span>string option</span>;</span></code></li><li id="type-subprocess_options.check_status" class="def record field anchored"><a href="#type-subprocess_options.check_status" class="anchor"></a><code><span>check_status : bool;</span></code></li><li id="type-subprocess_options.dump_output" class="def record field anchored"><a href="#type-subprocess_options.dump_output" class="anchor"></a><code><span>dump_output : bool;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-subprocess_options"><a href="#val-subprocess_options" class="anchor"></a><code><span><span class="keyword">val</span> subprocess_options : 
  <span>?timeout:<a href="../../Common/P_run/index.html#type-timeout_description">Common.P_run.timeout_description</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?hide_stdout:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?hide_stderr:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?error_message:string <span class="arrow">&#45;&gt;</span></span>
  <span>?check_status:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?dump_output:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-subprocess_options">subprocess_options</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-subprocess"><a href="#val-subprocess" class="anchor"></a><code><span><span class="keyword">val</span> subprocess : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?options:<a href="#type-subprocess_options">subprocess_options</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?args:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <a href="../../Common/P_run/index.html#type-result">Common.P_run.result</a>)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-dune"><a href="#val-dune" class="anchor"></a><code><span><span class="keyword">val</span> dune : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?options:<a href="#type-subprocess_options">subprocess_options</a> <span class="arrow">&#45;&gt;</span></span>
  <span>root:string <span class="arrow">&#45;&gt;</span></span>
  <span>?args:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <a href="../../Common/P_run/index.html#type-result">Common.P_run.result</a>)</span> <a href="../Task_tree/index.html#type-t">Task_tree.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-timeout_for"><a href="#val-timeout_for" class="anchor"></a><code><span><span class="keyword">val</span> timeout_for : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[&lt; `Build <span>| `Probe</span> <span>| `Test</span> ]</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Mtime</span>.span</span></code></div></div></div></body></html>