<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Grading (less-power.Test_lib.Grading)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.4"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">less-power</a> &#x00BB; <a href="../index.html">Test_lib</a> &#x00BB; Grading</nav><header class="odoc-preamble"><h1>Module <code><span>Test_lib.Grading</span></code></h1><p>Provide a grade from a list of passed/failed tests and a grading scheme. Provides functionality to load tests from a JUnit XML file, tidy them up, and write the grading result back to a JUnit XML file.</p></header><nav class="odoc-toc"><ul><li><a href="#grading">Grading</a></li><li><a href="#reading-and-writing">Reading and writing</a><ul><li><a href="#reading-and-clean-up">Reading and clean up</a></li><li><a href="#writing">Writing</a></li><li><a href="#helpers">Helpers</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="grading"><a href="#grading" class="anchor"></a>Grading</h2><div class="odoc-spec"><div class="spec type anchored" id="type-clamp"><a href="#type-clamp" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a clamp</span></span><span> = </span><span>{</span></code><ol><li id="type-clamp.min" class="def record field anchored"><a href="#type-clamp.min" class="anchor"></a><code><span>min : <span class="type-var">'a</span>;</span></code></li><li id="type-clamp.max" class="def record field anchored"><a href="#type-clamp.max" class="anchor"></a><code><span>max : <span class="type-var">'a</span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>A range of values, inclusive.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-clamp"><a href="#val-clamp" class="anchor"></a><code><span><span class="keyword">val</span> clamp : <span><span><span class="type-var">'a</span> <a href="#type-clamp">clamp</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>clamp { min = x; max = y } z</code> constrains <code>z</code> between <code>x</code> and <code>y</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-clamp_opt"><a href="#val-clamp_opt" class="anchor"></a><code><span><span class="keyword">val</span> clamp_opt : <span><span><span><span class="type-var">'a</span> <a href="#type-clamp">clamp</a></span> option</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>clamp None x</code> is <code>x</code>, otherwise as <a href="#val-clamp"><code>clamp</code></a>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-grading_result"><a href="#type-grading_result" class="anchor"></a><code><span><span class="keyword">type</span> grading_result</span><span> = </span><span>{</span></code><ol><li id="type-grading_result.text" class="def record field anchored"><a href="#type-grading_result.text" class="anchor"></a><code><span>text : string;</span></code></li><li id="type-grading_result.points" class="def record field anchored"><a href="#type-grading_result.points" class="anchor"></a><code><span>points : int;</span></code></li><li id="type-grading_result.max_points" class="def record field anchored"><a href="#type-grading_result.max_points" class="anchor"></a><code><span>max_points : int;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The result of grading a list of tests.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-tests"><a href="#type-tests" class="anchor"></a><code><span><span class="keyword">type</span> tests</span><span> = <span><span>(string * bool)</span> list</span></span></code></div><div class="spec-doc"><p>Pairs of <code>test_name, passed</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-testsuites"><a href="#type-testsuites" class="anchor"></a><code><span><span class="keyword">type</span> testsuites</span><span> = <span><a href="#type-tests">tests</a> list</span></span></code></div><div class="spec-doc"><p>A group of testsuites (e.g. as extracted from a single JUnit XML file)</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-grading_criterion"><a href="#type-grading_criterion" class="anchor"></a><code><span><span class="keyword">type</span> grading_criterion</span><span> = </span></code><ol><li id="type-grading_criterion.Passed" class="def variant constructor anchored"><a href="#type-grading_criterion.Passed" class="anchor"></a><code><span>| </span><span><span class="constructor">Passed</span> <span class="keyword">of</span> string</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Did the given test pass?</p><span class="comment-delim">*)</span></div></li><li id="type-grading_criterion.Failed" class="def variant constructor anchored"><a href="#type-grading_criterion.Failed" class="anchor"></a><code><span>| </span><span><span class="constructor">Failed</span> <span class="keyword">of</span> string</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Did the given test fail?</p><span class="comment-delim">*)</span></div></li><li id="type-grading_criterion.Not" class="def variant constructor anchored"><a href="#type-grading_criterion.Not" class="anchor"></a><code><span>| </span><span><span class="constructor">Not</span> <span class="keyword">of</span> <a href="#type-grading_criterion">grading_criterion</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Negation (logical not).</p><span class="comment-delim">*)</span></div></li><li id="type-grading_criterion.OneOf" class="def variant constructor anchored"><a href="#type-grading_criterion.OneOf" class="anchor"></a><code><span>| </span><span><span class="constructor">OneOf</span> <span class="keyword">of</span> <span><a href="#type-grading_criterion">grading_criterion</a> list</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Disjunction (logical or).</p><span class="comment-delim">*)</span></div></li><li id="type-grading_criterion.AllOf" class="def variant constructor anchored"><a href="#type-grading_criterion.AllOf" class="anchor"></a><code><span>| </span><span><span class="constructor">AllOf</span> <span class="keyword">of</span> <span><a href="#type-grading_criterion">grading_criterion</a> list</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Conjunction (logical and).</p><span class="comment-delim">*)</span></div></li><li id="type-grading_criterion.Constant" class="def variant constructor anchored"><a href="#type-grading_criterion.Constant" class="anchor"></a><code><span>| </span><span><span class="constructor">Constant</span> <span class="keyword">of</span> bool</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Logical constant.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Logical formulas over test results.</p><p><code>Passed</code> and <code>Failed</code> values may use wildcards:</p><ul><li>Trailing colon, e.g. <code>a:b:c:</code>: matches anything of which it is a prefix, e.g. <code>a:b:c:d:e</code> and <code>a:b:c</code>.</li><li>Star as name, e.g. <code>a:*:c</code>: matches any name in place of <code>*</code>, e.g. <code>a:mmm:c</code>.</li></ul><p>Both may be combined, e.g. <code>a:*:c:</code> matches <code>a:mm:c</code> and <code>a:nn:c:d</code>. A name is considered to be any string that does not contain a <code>:</code>. You are responsible for enforcing this convention yourself, it is not enforced by OUnit, for example.</p><p>For a <code>Passed</code> value to evaluate to true, <i>all</i> tests matched by the wildcard need to pass, and for <code>Failed</code> all need to fail. If you want the inverse behavior (<i>at least</i> one matched test needs to pass/fail), use <code>Not</code>: <code>Not (Failed &quot;a:*:&quot;)</code> means &quot;not all matched tests failed&quot;, which is logically equivalent to &quot;at least one matched test passed&quot;. For this, you can use <a href="#val-any_passed"><code>any_passed</code></a> and <a href="#val-any_failed"><code>any_failed</code></a>.</p><p>It is an error to reference a test that does not exist. In the presence of wildcards, at least one test must match.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-implies"><a href="#val-implies" class="anchor"></a><code><span><span class="keyword">val</span> implies : <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-grading_criterion">grading_criterion</a></span></code></div><div class="spec-doc"><p>Logical implication: <code>implies a c = OneOf [Not a; c]</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-any_passed"><a href="#val-any_passed" class="anchor"></a><code><span><span class="keyword">val</span> any_passed : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-grading_criterion">grading_criterion</a></span></code></div><div class="spec-doc"><p>If a test case contains a wildcard, the behavior is to require that all tests that match pass (or that all tests fail). Use <code>any_passed</code> (and <code>any_failed</code>) to instead check that at least one test that matches passed (or at least one test that matches failed).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-any_failed"><a href="#val-any_failed" class="anchor"></a><code><span><span class="keyword">val</span> any_failed : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-grading_criterion">grading_criterion</a></span></code></div><div class="spec-doc"><p>See <a href="#val-any_passed"><code>any_passed</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-evaluate_criterion"><a href="#val-evaluate_criterion" class="anchor"></a><code><span><span class="keyword">val</span> evaluate_criterion : <span><a href="#type-tests">tests</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Evaluate the logical formula over the assignment of test names to boolean pass/fail values.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_grading_criterion"><a href="#val-string_of_grading_criterion" class="anchor"></a><code><span><span class="keyword">val</span> string_of_grading_criterion : <span><span class="optlabel">?indent</span>:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-grading"><a href="#type-grading" class="anchor"></a><code><span><span class="keyword">type</span> grading</span><span> = </span></code><ol><li id="type-grading.Points" class="def variant constructor anchored"><a href="#type-grading.Points" class="anchor"></a><code><span>| </span><span><span class="constructor">Points</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-grading.title" class="def record field anchored"><a href="#type-grading.title" class="anchor"></a><code><span>title : string;</span></code></li><li id="type-grading.points" class="def record field anchored"><a href="#type-grading.points" class="anchor"></a><code><span>points : int;</span></code></li><li id="type-grading.test_case" class="def record field anchored"><a href="#type-grading.test_case" class="anchor"></a><code><span>test_case : <a href="#type-grading_criterion">grading_criterion</a>;</span></code></li><li id="type-grading.reason" class="def record field anchored"><a href="#type-grading.reason" class="anchor"></a><code><span>reason : <span><a href="#type-tests">tests</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> string;</span></code></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>If the criterion <code>test_case</code> evaluates to <code>true</code>, assign a grade of <code>points</code>, otherwise <code>0</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-grading.Group" class="def variant constructor anchored"><a href="#type-grading.Group" class="anchor"></a><code><span>| </span><span><span class="constructor">Group</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-grading.title" class="def record field anchored"><a href="#type-grading.title" class="anchor"></a><code><span>title : string;</span></code></li><li id="type-grading.items" class="def record field anchored"><a href="#type-grading.items" class="anchor"></a><code><span>items : <span><a href="#type-grading">grading</a> list</span>;</span></code></li><li id="type-grading.max_points" class="def record field anchored"><a href="#type-grading.max_points" class="anchor"></a><code><span>max_points : <span><span>int <a href="#type-clamp">clamp</a></span> option</span>;</span></code></li><li id="type-grading.skip" class="def record field anchored"><a href="#type-grading.skip" class="anchor"></a><code><span>skip : <span>string option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>If <code>skip = Some r</code>, skip this group (assign a grade of <code>0</code>) with the reason <code>r</code>.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A group of grading schemes. Assign the sum of grades from the sub-items, with an optional minimum/maximum number of points.</p><span class="comment-delim">*)</span></div></li><li id="type-grading.Conditional" class="def variant constructor anchored"><a href="#type-grading.Conditional" class="anchor"></a><code><span>| </span><span><span class="constructor">Conditional</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-grading.condition" class="def record field anchored"><a href="#type-grading.condition" class="anchor"></a><code><span>condition : <a href="#type-grading_criterion">grading_criterion</a>;</span></code></li><li id="type-grading.message" class="def record field anchored"><a href="#type-grading.message" class="anchor"></a><code><span>message : string;</span></code></li><li id="type-grading.content" class="def record field anchored"><a href="#type-grading.content" class="anchor"></a><code><span>content : <a href="#type-grading">grading</a>;</span></code></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Assign a grade according to <code>content</code> if the <code>condition</code> evaluates to <code>true</code>, otherwise <code>0</code>.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Grading scheme. Defines how to assign a numeric grade for a given set of test results.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-No_reason"><a href="#exception-No_reason" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">No_reason</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-points"><a href="#val-points" class="anchor"></a><code><span><span class="keyword">val</span> points : 
  <span><span class="optlabel">?skip</span>:<a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?reason</span>:<span>(<span><a href="#type-tests">tests</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <span>string option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?penalty</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a></span></code></div><div class="spec-doc"><p>Wrapper for <a href="#type-grading.Points" title="grading.Points"><code>Points</code></a>. If <code>reason</code> returns <code>None</code> (the default), the displayed reason is decided by <code>penalty</code> and <code>points</code>:</p><ul><li><code>&quot;PASS&quot;</code>/<code>&quot;FAIL&quot;</code> if <code>points</code> is non-negative, or <code>penalty</code> is <code>true</code></li><li>If <code>points</code> is negative, or <code>penalty</code> is <code>false</code>, then the grading criterion must evaluate to <code>true</code> and the reason is <code>&quot;PENALTY&quot;</code>, otherwise <a href="#exception-No_reason"><code>No_reason</code></a> is raised during evaluation.</li></ul><p>If <code>reason</code> returns a value, that is used directly instead.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-assertion"><a href="#val-assertion" class="anchor"></a><code><span><span class="keyword">val</span> assertion : 
  <span><span class="optlabel">?message</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?title</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a></span></code></div><div class="spec-doc"><p>Wrapper for <a href="#type-grading.Points" title="grading.Points"><code>Points</code></a>, intended for debugging tests. If the given <a href="#type-grading_criterion"><code>grading_criterion</code></a> does not evaluate to true, the <code>message</code> is given as a reason along with a print-out of the criterion. Useful for verifying invariants between tests, e.g. that passing a more comprehensive test implies passing a test that tests a subset of functionality.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-points_p"><a href="#val-points_p" class="anchor"></a><code><span><span class="keyword">val</span> points_p : 
  <span><span class="optlabel">?skip</span>:<a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?reason</span>:<span>(<span><a href="#type-tests">tests</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <span>string option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?penalty</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-points_f"><a href="#val-points_f" class="anchor"></a><code><span><span class="keyword">val</span> points_f : 
  <span><span class="optlabel">?skip</span>:<a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?reason</span>:<span>(<span><a href="#type-tests">tests</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <span>string option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?penalty</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-points_c"><a href="#val-points_c" class="anchor"></a><code><span><span class="keyword">val</span> points_c : 
  <span><span class="optlabel">?skip</span>:<a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?reason</span>:<span>(<span><a href="#type-tests">tests</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <span>string option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?penalty</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span>bool <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a></span></code></div><div class="spec-doc"><p>As per <a href="#val-points"><code>points</code></a>, but with the grading criterion set to <a href="#type-grading_criterion.Passed" title="grading_criterion.Passed"><code>Passed</code></a>, <a href="#type-grading_criterion.Failed" title="grading_criterion.Failed"><code>Failed</code></a>, or <a href="#type-grading_criterion.Constant" title="grading_criterion.Constant"><code>Constant</code></a>, respectively.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-conditional"><a href="#val-conditional" class="anchor"></a><code><span><span class="keyword">val</span> conditional : <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading">grading</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-grading">grading</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-conditional_c"><a href="#val-conditional_c" class="anchor"></a><code><span><span class="keyword">val</span> conditional_c : <span>bool <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading">grading</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-grading">grading</a></span></code></div><div class="spec-doc"><p>Wrappers for <a href="#type-grading.Conditional" title="grading.Conditional"><code>Conditional</code></a>, with the given condition or a constant.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-group"><a href="#val-group" class="anchor"></a><code><span><span class="keyword">val</span> group : 
  <span><span class="optlabel">?skip</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?max_points</span>:<span>int <a href="#type-clamp">clamp</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-grading">grading</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a></span></code></div><div class="spec-doc"><p>Wrapper for <a href="#type-grading.Group" title="grading.Group"><code>Group</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-evaluate_grading"><a href="#val-evaluate_grading" class="anchor"></a><code><span><span class="keyword">val</span> evaluate_grading : 
  <span><span class="optlabel">?points_step_count</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-grading">grading</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-tests">tests</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading_result">grading_result</a></span></code></div><div class="spec-doc"><p>Calculates a grade from the description of the grading and the list of passed/failed tests.</p></div></div><h2 id="reading-and-writing"><a href="#reading-and-writing" class="anchor"></a>Reading and writing</h2><p>Functionality to read tests from JUnit XML files, clean up the files, and write evaluated grading to JUnit XML files.</p><h3 id="reading-and-clean-up"><a href="#reading-and-clean-up" class="anchor"></a>Reading and clean up</h3><div class="odoc-spec"><div class="spec value anchored" id="val-extract_cleanup_file"><a href="#val-extract_cleanup_file" class="anchor"></a><code><span><span class="keyword">val</span> extract_cleanup_file : <span><span class="optlabel">?cleanup_to</span>:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-testsuites">testsuites</a></span></code></div><div class="spec-doc"><p>Extract the list of testsuites from a JUnit XML file. If <code>cleanup_to</code> is given, write the result of tidying up the result back to disk. The paths may be identical, in which case the original file is overwritten.</p></div></div><h3 id="writing"><a href="#writing" class="anchor"></a>Writing</h3><div class="odoc-spec"><div class="spec value anchored" id="val-write_result"><a href="#val-write_result" class="anchor"></a><code><span><span class="keyword">val</span> write_result : <span><span class="optlabel">?log_result</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_result">grading_result</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Write a grading result to file. If <code>log_result</code> is <code>true</code> (default), print a human-readable summary of grading results to standard error.</p></div></div><h3 id="helpers"><a href="#helpers" class="anchor"></a>Helpers</h3><p>Helpers to perform the most common sequence of operations:</p><ol><li>Read a list of JUnit XML files, extracting their test suites, and (optionally) cleaning them up, in-place.</li><li>Evaluate the list of passing/failing tests on a given grading scheme.</li><li>Write the result to file.</li></ol><p>Steps 2 and 3 can be skipped if no grading scheme is used. These helpers always clean up in-place, i.e. overwrite the original XML file, which is the intended use.</p><div class="odoc-spec"><div class="spec value anchored" id="val-extract_cleanup_files"><a href="#val-extract_cleanup_files" class="anchor"></a><code><span><span class="keyword">val</span> extract_cleanup_files : <span><span class="optlabel">?cleanup</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-testsuites">testsuites</a></span></code></div><div class="spec-doc"><p>As <a href="#val-extract_cleanup_file"><code>extract_cleanup_file</code></a> but for a list of files. The list of testsuites from each file are concatenated to produce a single list of testsuites. If <code>cleanup</code> is <code>true</code> (default), then overwrite each file with the cleaned up result, otherwise don't clean up.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-process_files"><a href="#val-process_files" class="anchor"></a><code><span><span class="keyword">val</span> process_files : 
  <span><span class="optlabel">?cleanup</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?grade</span>:<span>(<a href="#type-grading">grading</a> * <span>int option</span> * string)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?log_result</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Combines <a href="#val-extract_cleanup_files"><code>extract_cleanup_files</code></a>, <a href="#val-evaluate_grading"><code>evaluate_grading</code></a> and <a href="#val-write_result"><code>write_result</code></a>.</p><p>Extracts grading and (optionally) cleans up in-place, as per <a href="#val-extract_cleanup_files"><code>extract_cleanup_files</code></a>. If <code>grade</code> is <code>Some (grading, points_step_count, path)</code>, then evaluate <code>grading</code> as per <a href="#val-evaluate_grading"><code>evaluate_grading</code></a> with the given <code>points_step_count</code>, and write the result to <code>path</code>, as per <a href="#val-write_result"><code>write_result</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-grading_options"><a href="#val-grading_options" class="anchor"></a><code><span><span class="keyword">val</span> grading_options : 
  <span><span class="optlabel">?points_step_count</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">grading_to</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-grading">grading</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a> * <span>int option</span> * string</span></code></div><div class="spec-doc"><p>Helper to write the <code>grade</code> argument to <a href="#val-process_files"><code>process_files</code></a> more nicely.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-prettify_results"><a href="#val-prettify_results" class="anchor"></a><code><span><span class="keyword">val</span> prettify_results : <span><span class="optlabel">?grading</span>:<a href="#type-grading">grading</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>As per <a href="#val-process_files"><code>process_files</code></a> with a single path and <code>~cleanup:true</code>. If <code>grading</code> is given, then that grading is passed through with a <code>point_step_count</code> of <code>1</code> and the grading result written to <code>grading.xml</code> in the same directory as the given file.</p><ul class="at-tags"><li class="deprecated"><span class="at-tag">deprecated</span> use process_files</li></ul></div></div></div></body></html>
