<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Grading (less-power.Test_lib.Grading)</title><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">less-power</a> &#x00BB; <a href="../index.html">Test_lib</a> &#x00BB; Grading</nav><header class="odoc-preamble"><h1>Module <code><span>Test_lib.Grading</span></code></h1><p>Provide a grade from a list of passed/failed tests and a grading scheme.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-clamp"><a href="#type-clamp" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a clamp</span></span><span> = </span><span>{</span></code><ol><li id="type-clamp.min" class="def record field anchored"><a href="#type-clamp.min" class="anchor"></a><code><span>min : <span class="type-var">'a</span>;</span></code></li><li id="type-clamp.max" class="def record field anchored"><a href="#type-clamp.max" class="anchor"></a><code><span>max : <span class="type-var">'a</span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>A range of values, inclusive.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-clamp"><a href="#val-clamp" class="anchor"></a><code><span><span class="keyword">val</span> clamp : <span><span><span class="type-var">'a</span> <a href="#type-clamp">clamp</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>clamp { min = x; max = y } z</code> constrains <code>z</code> between <code>x</code> and <code>y</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-clamp_opt"><a href="#val-clamp_opt" class="anchor"></a><code><span><span class="keyword">val</span> clamp_opt : <span><span><span><span class="type-var">'a</span> <a href="#type-clamp">clamp</a></span> option</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>clamp None x</code> is <code>x</code>, otherwise as <a href="#val-clamp"><code>clamp</code></a>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-grading_result"><a href="#type-grading_result" class="anchor"></a><code><span><span class="keyword">type</span> grading_result</span><span> = </span><span>{</span></code><ol><li id="type-grading_result.text" class="def record field anchored"><a href="#type-grading_result.text" class="anchor"></a><code><span>text : string;</span></code></li><li id="type-grading_result.points" class="def record field anchored"><a href="#type-grading_result.points" class="anchor"></a><code><span>points : int;</span></code></li><li id="type-grading_result.max_points" class="def record field anchored"><a href="#type-grading_result.max_points" class="anchor"></a><code><span>max_points : int;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The result of grading a list of tests.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-tests"><a href="#type-tests" class="anchor"></a><code><span><span class="keyword">type</span> tests</span><span> = <span><span>(string * bool)</span> list</span></span></code></div><div class="spec-doc"><p>Pairs of <code>test_name, passed</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-grading_criterion"><a href="#type-grading_criterion" class="anchor"></a><code><span><span class="keyword">type</span> grading_criterion</span><span> = </span></code><ol><li id="type-grading_criterion.Passed" class="def variant constructor anchored"><a href="#type-grading_criterion.Passed" class="anchor"></a><code><span>| </span><span><span class="constructor">Passed</span> <span class="keyword">of</span> string</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Did the given test pass?</p><span class="comment-delim">*)</span></div></li><li id="type-grading_criterion.Failed" class="def variant constructor anchored"><a href="#type-grading_criterion.Failed" class="anchor"></a><code><span>| </span><span><span class="constructor">Failed</span> <span class="keyword">of</span> string</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Did the given test fail?</p><span class="comment-delim">*)</span></div></li><li id="type-grading_criterion.Not" class="def variant constructor anchored"><a href="#type-grading_criterion.Not" class="anchor"></a><code><span>| </span><span><span class="constructor">Not</span> <span class="keyword">of</span> <a href="#type-grading_criterion">grading_criterion</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Negation (logical not).</p><span class="comment-delim">*)</span></div></li><li id="type-grading_criterion.OneOf" class="def variant constructor anchored"><a href="#type-grading_criterion.OneOf" class="anchor"></a><code><span>| </span><span><span class="constructor">OneOf</span> <span class="keyword">of</span> <span><a href="#type-grading_criterion">grading_criterion</a> list</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Disjunction (logical or).</p><span class="comment-delim">*)</span></div></li><li id="type-grading_criterion.AllOf" class="def variant constructor anchored"><a href="#type-grading_criterion.AllOf" class="anchor"></a><code><span>| </span><span><span class="constructor">AllOf</span> <span class="keyword">of</span> <span><a href="#type-grading_criterion">grading_criterion</a> list</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Conjunction (logical and).</p><span class="comment-delim">*)</span></div></li><li id="type-grading_criterion.Constant" class="def variant constructor anchored"><a href="#type-grading_criterion.Constant" class="anchor"></a><code><span>| </span><span><span class="constructor">Constant</span> <span class="keyword">of</span> bool</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Logical constant.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Logical formulas over test results.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-implies"><a href="#val-implies" class="anchor"></a><code><span><span class="keyword">val</span> implies : <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-grading_criterion">grading_criterion</a></span></code></div><div class="spec-doc"><p>Logical implication: <code>implies a c = OneOf [Not a; c]</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_grading_criterion"><a href="#val-string_of_grading_criterion" class="anchor"></a><code><span><span class="keyword">val</span> string_of_grading_criterion : <span>?indent:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-grading"><a href="#type-grading" class="anchor"></a><code><span><span class="keyword">type</span> grading</span><span> = </span></code><ol><li id="type-grading.Points" class="def variant constructor anchored"><a href="#type-grading.Points" class="anchor"></a><code><span>| </span><span><span class="constructor">Points</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-grading.title" class="def record field anchored"><a href="#type-grading.title" class="anchor"></a><code><span>title : string;</span></code></li><li id="type-grading.points" class="def record field anchored"><a href="#type-grading.points" class="anchor"></a><code><span>points : int;</span></code></li><li id="type-grading.test_case" class="def record field anchored"><a href="#type-grading.test_case" class="anchor"></a><code><span>test_case : <a href="#type-grading_criterion">grading_criterion</a>;</span></code></li><li id="type-grading.reason" class="def record field anchored"><a href="#type-grading.reason" class="anchor"></a><code><span>reason : <span><a href="#type-tests">tests</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> string;</span></code></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>If the criterion <code>test_case</code> evaluates to <code>true</code>, assign a grade of <code>points</code>, otherwise <code>0</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-grading.Group" class="def variant constructor anchored"><a href="#type-grading.Group" class="anchor"></a><code><span>| </span><span><span class="constructor">Group</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-grading.title" class="def record field anchored"><a href="#type-grading.title" class="anchor"></a><code><span>title : string;</span></code></li><li id="type-grading.items" class="def record field anchored"><a href="#type-grading.items" class="anchor"></a><code><span>items : <span><a href="#type-grading">grading</a> list</span>;</span></code></li><li id="type-grading.max_points" class="def record field anchored"><a href="#type-grading.max_points" class="anchor"></a><code><span>max_points : <span><span>int <a href="#type-clamp">clamp</a></span> option</span>;</span></code></li><li id="type-grading.skip" class="def record field anchored"><a href="#type-grading.skip" class="anchor"></a><code><span>skip : <span>string option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>If <code>skip = Some r</code>, skip this group (assign a grade of <code>0</code>) with the reason <code>r</code>.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A group of grading schemes. Assign the sum of grades from the sub-items, with an optional minimum/maximum number of points.</p><span class="comment-delim">*)</span></div></li><li id="type-grading.Conditional" class="def variant constructor anchored"><a href="#type-grading.Conditional" class="anchor"></a><code><span>| </span><span><span class="constructor">Conditional</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-grading.condition" class="def record field anchored"><a href="#type-grading.condition" class="anchor"></a><code><span>condition : <a href="#type-grading_criterion">grading_criterion</a>;</span></code></li><li id="type-grading.message" class="def record field anchored"><a href="#type-grading.message" class="anchor"></a><code><span>message : string;</span></code></li><li id="type-grading.content" class="def record field anchored"><a href="#type-grading.content" class="anchor"></a><code><span>content : <a href="#type-grading">grading</a>;</span></code></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Assign a grade according to <code>content</code> if the <code>condition</code> evaluates to <code>true</code>, otherwise <code>0</code>.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Grading scheme. Defines how to assign a numeric grade for a given set of test results.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-No_reason"><a href="#exception-No_reason" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">No_reason</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-points"><a href="#val-points" class="anchor"></a><code><span><span class="keyword">val</span> points : 
  <span>?reason:<span>(<span><a href="#type-tests">tests</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <span>string option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?penalty:bool <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a></span></code></div><div class="spec-doc"><p>Wrapper for <a href="#type-grading.Points"><code>Points</code></a>. If <code>reason</code> returns <code>None</code> (the default), the displayed reason is decided by <code>penalty</code> and <code>points</code>:</p><ul><li><code>&quot;PASS&quot;</code>/<code>&quot;FAIL&quot;</code> if <code>points</code> is non-negative, or <code>penalty</code> is <code>true</code></li><li>If <code>points</code> is negative, or <code>penalty</code> is <code>false</code>, then the grading criterion must evaluate to <code>true</code> and the reason is <code>&quot;PENALTY&quot;</code>, otherwise <a href="#exception-No_reason"><code>No_reason</code></a> is raised during evaluation.</li></ul><p>If <code>reason</code> returns a value, that is used directly instead.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-assertion"><a href="#val-assertion" class="anchor"></a><code><span><span class="keyword">val</span> assertion : 
  <span>?message:string <span class="arrow">&#45;&gt;</span></span>
  <span>?title:string <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a></span></code></div><div class="spec-doc"><p>Wrapper for <a href="#type-grading.Points"><code>Points</code></a>, intended for debugging tests. If the given <a href="#type-grading_criterion"><code>grading_criterion</code></a> does not evaluate to true, the <code>message</code> is given as a reason along with a print-out of the criterion. Useful for verifying invariants between tests, e.g. that passing a more comprehensive test implies passing a test that tests a subset of functionality.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-points_p"><a href="#val-points_p" class="anchor"></a><code><span><span class="keyword">val</span> points_p : 
  <span>?reason:<span>(<span><a href="#type-tests">tests</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <span>string option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?penalty:bool <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-points_f"><a href="#val-points_f" class="anchor"></a><code><span><span class="keyword">val</span> points_f : 
  <span>?reason:<span>(<span><a href="#type-tests">tests</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <span>string option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?penalty:bool <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-points_c"><a href="#val-points_c" class="anchor"></a><code><span><span class="keyword">val</span> points_c : 
  <span>?reason:<span>(<span><a href="#type-tests">tests</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <span>string option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?penalty:bool <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span>bool <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a></span></code></div><div class="spec-doc"><p>As per <a href="#val-points"><code>points</code></a>, but with the grading criterion set to <a href="#type-grading_criterion.Passed"><code>Passed</code></a>, <a href="#type-grading_criterion.Failed"><code>Failed</code></a>, or <a href="#type-grading_criterion.Constant"><code>Constant</code></a>, respectively.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-conditional"><a href="#val-conditional" class="anchor"></a><code><span><span class="keyword">val</span> conditional : <span><a href="#type-grading_criterion">grading_criterion</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading">grading</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-grading">grading</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-conditional_c"><a href="#val-conditional_c" class="anchor"></a><code><span><span class="keyword">val</span> conditional_c : <span>bool <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grading">grading</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-grading">grading</a></span></code></div><div class="spec-doc"><p>Wrappers for <a href="#type-grading.Conditional"><code>Conditional</code></a>, with the given condition or a constant.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-group"><a href="#val-group" class="anchor"></a><code><span><span class="keyword">val</span> group : 
  <span>?skip:string <span class="arrow">&#45;&gt;</span></span>
  <span>?max_points:<span>int <a href="#type-clamp">clamp</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-grading">grading</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-grading">grading</a></span></code></div><div class="spec-doc"><p>Wrapper for <a href="#type-grading.Group"><code>Group</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-prettify_results"><a href="#val-prettify_results" class="anchor"></a><code><span><span class="keyword">val</span> prettify_results : 
  <span>?grading:<a href="#type-grading">grading</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?points_step_count:int <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Main entry point: <code>prettify_results ~grading file_name</code> reads the JUnit XML file in <code>file_name</code>, evalutes the given <code>grading</code> scheme and writes the result back to the same file.</p></div></div></div></body></html>