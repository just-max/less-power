<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Std_task (less-power.Test_runner.Std_task)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">less-power</a> &#x00BB; <a href="../index.html">Test_runner</a> &#x00BB; Std_task</nav><header class="odoc-preamble"><h1>Module <code><span>Test_runner.Std_task</span></code></h1><p>Common tasks and tasks for the standard test setup.</p></header><nav class="odoc-toc"><ul><li><a href="#common-tasks">Common tasks</a></li><li><a href="#standard-tasks">Standard tasks</a></li><li><a href="#probe-related-tasks-(partial-type-correctness-checking)">Probe-related tasks (partial type correctness checking)</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-f"><a href="#val-f" class="anchor"></a><code><span><span class="keyword">val</span> f : <span><span><span>(<span class="type-var">'a</span>, unit, string)</span> <span class="xref-unresolved">Stdlib</span>.format</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div></div><h2 id="common-tasks"><a href="#common-tasks" class="anchor"></a>Common tasks</h2><div class="odoc-spec"><div class="spec value anchored" id="val-contains_symlink"><a href="#val-contains_symlink" class="anchor"></a><code><span><span class="keyword">val</span> contains_symlink : <span>string <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Check if the directory contains a symlink. The directory itself may be a symlink.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Messages"><a href="#module-Messages" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Messages/index.html">Messages</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-cfg"><a href="#type-cfg" class="anchor"></a><code><span><span class="keyword">type</span> cfg</span><span> = </span><span>{</span></code><ol><li id="type-cfg.build_root" class="def record field anchored"><a href="#type-cfg.build_root" class="anchor"></a><code><span>build_root : <span class="xref-unresolved">FilePath</span>.filename;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>relative paths are OK</p><span class="comment-delim">*)</span></div></li><li id="type-cfg.safe" class="def record field anchored"><a href="#type-cfg.safe" class="anchor"></a><code><span>safe : bool;</span></code></li><li id="type-cfg.build_timeout" class="def record field anchored"><a href="#type-cfg.build_timeout" class="anchor"></a><code><span>build_timeout : <span class="xref-unresolved">Mtime</span>.span;</span></code></li><li id="type-cfg.test_timeout" class="def record field anchored"><a href="#type-cfg.test_timeout" class="anchor"></a><code><span>test_timeout : <span class="xref-unresolved">Mtime</span>.span;</span></code></li><li id="type-cfg.probe_timeout" class="def record field anchored"><a href="#type-cfg.probe_timeout" class="anchor"></a><code><span>probe_timeout : <span class="xref-unresolved">Mtime</span>.span;</span></code></li><li id="type-cfg.timestamp_now" class="def record field anchored"><a href="#type-cfg.timestamp_now" class="anchor"></a><code><span>timestamp_now : <span>float option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Override current time, UTC</p><span class="comment-delim">*)</span></div></li><li id="type-cfg.exercise_start" class="def record field anchored"><a href="#type-cfg.exercise_start" class="anchor"></a><code><span>exercise_start : float;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>UTC time</p><span class="comment-delim">*)</span></div></li><li id="type-cfg.exercise_end" class="def record field anchored"><a href="#type-cfg.exercise_end" class="anchor"></a><code><span>exercise_end : float;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>UTC time</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check_contains_symlink"><a href="#val-check_contains_symlink" class="anchor"></a><code><span><span class="keyword">val</span> check_contains_symlink : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_file_pp"><a href="#val-write_file_pp" class="anchor"></a><code><span><span class="keyword">val</span> write_file_pp : 
  <span><span class="optlabel">?label</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'b</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_file_f"><a href="#val-write_file_f" class="anchor"></a><code><span><span class="keyword">val</span> write_file_f : 
  <span><span class="optlabel">?label</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.Format.formatter, unit, <span><span>(<span class="type-var">'b</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_file_str"><a href="#val-write_file_str" class="anchor"></a><code><span><span class="keyword">val</span> write_file_str : 
  <span><span class="optlabel">?label</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-configure_show_hidden"><a href="#val-configure_show_hidden" class="anchor"></a><code><span><span class="keyword">val</span> configure_show_hidden : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-remove_files"><a href="#val-remove_files" class="anchor"></a><code><span><span class="keyword">val</span> remove_files : 
  <span><span class="optlabel">?condition</span>:<span class="xref-unresolved">FileUtil</span>.test_file <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Task: remove the files which match <code>condition</code> (default: <code>.ml</code> files). Not recursive: only files in <code>p</code> will be deleted, not in subdirectories.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-copy_files"><a href="#val-copy_files" class="anchor"></a><code><span><span class="keyword">val</span> copy_files : 
  <span><span class="optlabel">?condition</span>:<span class="xref-unresolved">FileUtil</span>.test_file <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Task: copy the files which match <code>condition</code> (default: <code>.ml</code> files). Not recursive: only files in <code>src0</code> will be copied, not in subdirectories.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-load_files"><a href="#val-load_files" class="anchor"></a><code><span><span class="keyword">val</span> load_files : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?condition</span>:<span class="xref-unresolved">FileUtil</span>.test_file <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Composition of <a href="#val-remove_files"><code>remove_files</code></a> and <a href="#val-load_files"><code>load_files</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_clean_directory"><a href="#val-make_clean_directory" class="anchor"></a><code><span><span class="keyword">val</span> make_clean_directory : 
  <span><span class="optlabel">?remove</span>:<span class="xref-unresolved">FileUtil</span>.test_file <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_test_report_directory"><a href="#val-make_test_report_directory" class="anchor"></a><code><span><span class="keyword">val</span> make_test_report_directory : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-checker"><a href="#val-checker" class="anchor"></a><code><span><span class="keyword">val</span> checker : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?prohibited</span>:<span class="xref-unresolved">Ast_check</span>.Feature.Set.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?limit</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?check1</span>:<span class="xref-unresolved">FileUtil</span>.test_file <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?check</span>:<span class="xref-unresolved">FileUtil</span>.test_file <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Run the <a href="../../Ast_check/index.html#val-path_violations" title="Ast_check.path_violations">AST-checker</a> as a task.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-subprocess_run"><a href="#val-subprocess_run" class="anchor"></a><code><span><span class="keyword">val</span> subprocess_run : 
  <span><span class="optlabel">?timeout</span>:<a href="../../Common/P_run/index.html#type-timeout_description">Common.P_run.timeout_description</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?args</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?env</span>:<span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <a href="../../Common/P_run/index.html#type-result">Common.P_run.result</a>)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Run a process as a task</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-subprocess_result"><a href="#val-subprocess_result" class="anchor"></a><code><span><span class="keyword">val</span> subprocess_result : 
  <span><span class="optlabel">?hide_stdout</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hide_stderr</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?command_line</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?error_message</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?check_status</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dump_output</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../Common/P_run/index.html#type-result">Common.P_run.result</a>, <a href="../../Common/P_run/index.html#type-result">Common.P_run.result</a>)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Handle the result of a subprocess task.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-subprocess_options"><a href="#type-subprocess_options" class="anchor"></a><code><span><span class="keyword">type</span> subprocess_options</span><span> = </span><span>{</span></code><ol><li id="type-subprocess_options.timeout" class="def record field anchored"><a href="#type-subprocess_options.timeout" class="anchor"></a><code><span>timeout : <span><a href="../../Common/P_run/index.html#type-timeout_description">Common.P_run.timeout_description</a> option</span>;</span></code></li><li id="type-subprocess_options.hide_stdout" class="def record field anchored"><a href="#type-subprocess_options.hide_stdout" class="anchor"></a><code><span>hide_stdout : bool;</span></code></li><li id="type-subprocess_options.hide_stderr" class="def record field anchored"><a href="#type-subprocess_options.hide_stderr" class="anchor"></a><code><span>hide_stderr : bool;</span></code></li><li id="type-subprocess_options.error_message" class="def record field anchored"><a href="#type-subprocess_options.error_message" class="anchor"></a><code><span>error_message : <span>string option</span>;</span></code></li><li id="type-subprocess_options.check_status" class="def record field anchored"><a href="#type-subprocess_options.check_status" class="anchor"></a><code><span>check_status : bool;</span></code></li><li id="type-subprocess_options.dump_output" class="def record field anchored"><a href="#type-subprocess_options.dump_output" class="anchor"></a><code><span>dump_output : bool;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-subprocess_options"><a href="#val-subprocess_options" class="anchor"></a><code><span><span class="keyword">val</span> subprocess_options : 
  <span><span class="optlabel">?timeout</span>:<a href="../../Common/P_run/index.html#type-timeout_description">Common.P_run.timeout_description</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hide_stdout</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hide_stderr</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?error_message</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?check_status</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dump_output</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-subprocess_options">subprocess_options</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-subprocess"><a href="#val-subprocess" class="anchor"></a><code><span><span class="keyword">val</span> subprocess : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?options</span>:<a href="#type-subprocess_options">subprocess_options</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?args</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?env</span>:<span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <a href="../../Common/P_run/index.html#type-result">Common.P_run.result</a>)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-dune"><a href="#val-dune" class="anchor"></a><code><span><span class="keyword">val</span> dune : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?options</span>:<a href="#type-subprocess_options">subprocess_options</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">root</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?args</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?env</span>:<span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <a href="../../Common/P_run/index.html#type-result">Common.P_run.result</a>)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-timeout_for"><a href="#val-timeout_for" class="anchor"></a><code><span><span class="keyword">val</span> timeout_for : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[&lt; `Build <span>| `Probe</span> <span>| `Test</span> ]</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Mtime</span>.span</span></code></div></div><h2 id="standard-tasks"><a href="#standard-tasks" class="anchor"></a>Standard tasks</h2><p>These are high-level tasks built upon the primitives defined above. They work with the recommended layout of tests, submission and sample solution. However, the low-level tasks defined above can also be used as needed.</p><div class="odoc-spec"><div class="spec value anchored" id="val-std_test_report_dir"><a href="#val-std_test_report_dir" class="anchor"></a><code><span><span class="keyword">val</span> std_test_report_dir : string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-std_setup"><a href="#val-std_setup" class="anchor"></a><code><span><span class="keyword">val</span> std_setup : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Set up the test environment.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-std_check"><a href="#val-std_check" class="anchor"></a><code><span><span class="keyword">val</span> std_check : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Run the limitation checker.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-std_build1"><a href="#val-std_build1" class="anchor"></a><code><span><span class="keyword">val</span> std_build1 : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?submission</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?env</span>:<span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Build something in the <code>tests/</code> directory with dune. If <code>submission</code> is <code>false</code> (default), error output is hidden.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-std_exec1"><a href="#val-std_exec1" class="anchor"></a><code><span><span class="keyword">val</span> std_exec1 : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?phase</span>:<span>[&lt; `Build <span>| `Probe</span> <span>| `Test</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?args</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?env</span>:<span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Run something in the <code>tests/</code> directory with <code>dune exec</code>.</p><p>This task passes the <code>--no-build</code> flag to dune. As such:</p><ul><li>The executable must be built before running this task (e.g. with <a href="#val-std_build1"><code>std_build1</code></a>).</li><li>There is no risk of showing the build output to the student.</li></ul><p>If <code>phase</code> is given, sets a timeout.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-std_build"><a href="#val-std_build" class="anchor"></a><code><span><span class="keyword">val</span> std_build : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Build the assignment library and test binary.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-std_exec_test"><a href="#val-std_exec_test" class="anchor"></a><code><span><span class="keyword">val</span> std_exec_test : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?env</span>:<span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">output_junit_file</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(unit, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Run a test executable in the standard setup. See the note about building first in <a href="#val-std_exec1"><code>std_exec1</code></a>. Assumes the test executable is configured to exit immediately if no command line arguments are passed. We use this to check that the top level code of the submission does not contain any long-running code. If it does, there's no point in running the tests, since the significantly longer test timeout will just kill them. We don't want to prohibit top-level code entirely, since it would prevent things like <code>let impl0 = impl 0</code>.</p><p>Thus, first runs the given executable without any arguments, then runs it a second time, with the given <code>output_junit_file</code> (interpreted relative to the <code>test-reports/</code> directory) as the output JUnit file.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-std_output_junit_file"><a href="#val-std_output_junit_file" class="anchor"></a><code><span><span class="keyword">val</span> std_output_junit_file : string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-std_grading_junit_file"><a href="#val-std_grading_junit_file" class="anchor"></a><code><span><span class="keyword">val</span> std_grading_junit_file : string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-std_test"><a href="#val-std_test" class="anchor"></a><code><span><span class="keyword">val</span> std_test : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>As <a href="#val-std_exec_test"><code>std_exec_test</code></a>, fixed to <code>test/test.exe</code> with output to <code>test-reports/results.xml</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-std_exec_process_results"><a href="#val-std_exec_process_results" class="anchor"></a><code><span><span class="keyword">val</span> std_exec_process_results : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>Run an executable that processes the test results in the standard setup. Executes <code>test/process_results.exe</code>. See the note about building first in <a href="#val-std_exec1"><code>std_exec1</code></a>.</p><p>The given file names are taken relative to the <code>test-reports/</code> directory and passed to the executable.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-std_process_results"><a href="#val-std_process_results" class="anchor"></a><code><span><span class="keyword">val</span> std_process_results : 
  <span><span class="optlabel">?grading</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?output_junit_files</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>As <a href="#val-std_exec_process_results"><code>std_exec_process_results</code></a>, but: if <code>grading</code> is <code>true</code>, the first argument to the executable is <code>test-reports/grading.xml</code>. In any case, the remaining <code>output_junit_files</code> (taken relative to the <code>test-reports/</code> directory) follow, which defaults to <code>[&quot;results.xml&quot;]</code>.</p></div></div><h2 id="probe-related-tasks-(partial-type-correctness-checking)"><a href="#probe-related-tasks-(partial-type-correctness-checking)" class="anchor"></a>Probe-related tasks (partial type correctness checking)</h2><div class="odoc-spec"><div class="spec type anchored" id="type-probe_result"><a href="#type-probe_result" class="anchor"></a><code><span><span class="keyword">type</span> probe_result</span><span> = </span><span>{</span></code><ol><li id="type-probe_result.name" class="def record field anchored"><a href="#type-probe_result.name" class="anchor"></a><code><span>name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>the name given to the probe definition</p><span class="comment-delim">*)</span></div></li><li id="type-probe_result.ok" class="def record field anchored"><a href="#type-probe_result.ok" class="anchor"></a><code><span>ok : bool;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>did the check pass?</p><span class="comment-delim">*)</span></div></li><li id="type-probe_result.message" class="def record field anchored"><a href="#type-probe_result.message" class="anchor"></a><code><span>message : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>compiler output</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-probe_result_of_prun_result"><a href="#val-probe_result_of_prun_result" class="anchor"></a><code><span><span class="keyword">val</span> probe_result_of_prun_result : 
  <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Common/P_run/index.html#type-result">Common.P_run.result</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-probe_result">probe_result</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-defines_of_probe_result"><a href="#val-defines_of_probe_result" class="anchor"></a><code><span><span class="keyword">val</span> defines_of_probe_result : <span><a href="#type-probe_result">probe_result</a> <span class="arrow">&#45;&gt;</span></span> <span>string list</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_probe_name"><a href="#val-is_probe_name" class="anchor"></a><code><span><span class="keyword">val</span> is_probe_name : <span><span class="xref-unresolved">Stdlib</span>.String.t <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>[A-Z_]*</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-load_probe_items"><a href="#val-load_probe_items" class="anchor"></a><code><span><span class="keyword">val</span> load_probe_items : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">defs</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <span><span>(string * <span class="xref-unresolved">Parsetree</span>.structure)</span> list</span>)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>parse the probe items from the given path</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-probe_dune"><a href="#val-probe_dune" class="anchor"></a><code><span><span class="keyword">val</span> probe_dune : <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="label">dep</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-probe_dir_path"><a href="#val-probe_dir_path" class="anchor"></a><code><span><span class="keyword">val</span> probe_dir_path : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-gen_probe"><a href="#val-gen_probe" class="anchor"></a><code><span><span class="keyword">val</span> gen_probe : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">data_dir</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dep</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Parsetree</span>.structure <span class="arrow">&#45;&gt;</span></span>
  <span><span>(unit, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run_probe"><a href="#val-run_probe" class="anchor"></a><code><span><span class="keyword">val</span> run_probe : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">root</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">data_dir</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <a href="#type-probe_result">probe_result</a>)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>unlike the other tasks, <code>data_dir</code> needs to be relative to <code>root</code> here</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-handle_probe_results"><a href="#val-handle_probe_results" class="anchor"></a><code><span><span class="keyword">val</span> handle_probe_results : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">args_file</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="#type-probe_result">probe_result</a> list</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-probe"><a href="#val-probe" class="anchor"></a><code><span><span class="keyword">val</span> probe : 
  <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">root</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">defs</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dep</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">data_dir</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">args_file</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div><div class="spec-doc"><p>all paths are relative to <code>root</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-std_probe"><a href="#val-std_probe" class="anchor"></a><code><span><span class="keyword">val</span> std_probe : <span><a href="#type-cfg">cfg</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, unit)</span> <a href="../Task/index.html#type-tree">Task.tree</a></span></span></code></div></div></div></body></html>
