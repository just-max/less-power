<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>P_run (less-power.Common.P_run)</title><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v2.3.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">less-power</a> &#x00BB; <a href="../index.html">Common</a> &#x00BB; P_run</nav><header class="odoc-preamble"><h1>Module <code><span>Common.P_run</span></code></h1><p>Even higher-level wrapper around <code>Unix.open_process</code>.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-wait_pid_timeout"><a href="#val-wait_pid_timeout" class="anchor"></a><code><span><span class="keyword">val</span> wait_pid_timeout : <span><span class="xref-unresolved">Mtime</span>.span <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Unix</span>.process_status option</span></span></code></div><div class="spec-doc"><p>Waits for the given process or times out.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-timeout_description"><a href="#type-timeout_description" class="anchor"></a><code><span><span class="keyword">type</span> timeout_description</span><span> = </span><span>{</span></code><ol><li id="type-timeout_description.duration" class="def record field anchored"><a href="#type-timeout_description.duration" class="anchor"></a><code><span>duration : <span class="xref-unresolved">Mtime</span>.span;</span></code></li><li id="type-timeout_description.signal" class="def record field anchored"><a href="#type-timeout_description.signal" class="anchor"></a><code><span>signal : int;</span></code></li><li id="type-timeout_description.kill_after" class="def record field anchored"><a href="#type-timeout_description.kill_after" class="anchor"></a><code><span>kill_after : <span><span class="xref-unresolved">Mtime</span>.span option</span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Timeout after <code>duration</code>, sending <code>signal</code>. If <code>kill_after</code> is <code>Some t</code>, then send <code>SIGKILL</code> after waiting an additional <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-timeout"><a href="#val-timeout" class="anchor"></a><code><span><span class="keyword">val</span> timeout : 
  <span><span class="optlabel">?signal</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?kill_after</span>:<span class="xref-unresolved">Mtime</span>.span <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Mtime</span>.span <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-timeout_description">timeout_description</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-phase"><a href="#type-phase" class="anchor"></a><code><span><span class="keyword">type</span> phase</span><span> = </span></code><ol><li id="type-phase.Completed" class="def variant constructor anchored"><a href="#type-phase.Completed" class="anchor"></a><code><span>| </span><span><span class="constructor">Completed</span></span></code></li><li id="type-phase.TimedOut" class="def variant constructor anchored"><a href="#type-phase.TimedOut" class="anchor"></a><code><span>| </span><span><span class="constructor">TimedOut</span></span></code></li><li id="type-phase.Killed" class="def variant constructor anchored"><a href="#type-phase.Killed" class="anchor"></a><code><span>| </span><span><span class="constructor">Killed</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Whether the process is running normally, has received the first signal, or has received a SIGKILL.</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-result"><a href="#type-result" class="anchor"></a><code><span><span class="keyword">type</span> result</span><span> = </span><span>{</span></code><ol><li id="type-result.phase" class="def record field anchored"><a href="#type-result.phase" class="anchor"></a><code><span>phase : <a href="#type-phase">phase</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>What phase was the process in when it completed?</p><span class="comment-delim">*)</span></div></li><li id="type-result.status" class="def record field anchored"><a href="#type-result.status" class="anchor"></a><code><span>status : <span class="xref-unresolved">Unix</span>.process_status;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>What status did the process exit with?</p><span class="comment-delim">*)</span></div></li><li id="type-result.stdout" class="def record field anchored"><a href="#type-result.stdout" class="anchor"></a><code><span>stdout : string;</span></code></li><li id="type-result.stderr" class="def record field anchored"><a href="#type-result.stderr" class="anchor"></a><code><span>stderr : string;</span></code></li><li id="type-result.elapsed" class="def record field anchored"><a href="#type-result.elapsed" class="anchor"></a><code><span>elapsed : <span class="xref-unresolved">Mtime</span>.span;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-result_is_ok"><a href="#val-result_is_ok" class="anchor"></a><code><span><span class="keyword">val</span> result_is_ok : <span><span class="optlabel">?check_status</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-result">result</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Did the subprocess exit normally? If <code>check_status</code> is <code>false</code>, ignore the exit code and check only for a timeout or signal</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_result"><a href="#val-pp_result" class="anchor"></a><code><span><span class="keyword">val</span> pp_result : 
  <span><span class="optlabel">?hide_stdout</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hide_stderr</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?command_line</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-result">result</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-build_env"><a href="#val-build_env" class="anchor"></a><code><span><span class="keyword">val</span> build_env : <span><span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span>string list</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-p_run"><a href="#val-p_run" class="anchor"></a><code><span><span class="keyword">val</span> p_run : 
  <span><span class="optlabel">?timeout</span>:<a href="#type-timeout_description">timeout_description</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?input</span>:<span>(<span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?args</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?env</span>:<span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-result">result</a></span></code></div><div class="spec-doc"><p>Send the <code>input</code> to <code>command</code> with the given <code>args</code>. Note: uses temporary files provided by <code>Filename</code>.</p></div></div></div></body></html>
